
#!/usr/bin/env python3
"""
üåå LuxDB v2 - Operacje na danych w wymiarach

Demonstruje manifestowanie, kontemplacjƒô i ewolucjƒô byt√≥w
"""

import sys
import os
import time
from datetime import datetime, timedelta

# Dodaj ≈õcie≈ºkƒô do LuxDB v2
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__)))))

from luxdb_v2 import create_astral_app, print_astral_banner


def example_being_manifestation():
    """Przyk≈Çad manifestowania byt√≥w w wymiarach"""
    print("‚ú® Przyk≈Çad 1: Manifestowanie byt√≥w")
    print("=" * 50)
    
    config = {
        'realms': {
            'souls': 'memory://soul_dimension',
            'artifacts': 'memory://artifact_dimension'
        }
    }
    
    with create_astral_app(config) as engine:
        # Pobierz wymiar dusz
        soul_realm = engine.get_realm('souls')
        
        print("üåü Manifestowanie dusz w wymiarze...")
        
        # Manifestuj dusze
        souls_data = [
            {
                'soul_name': 'Guardian_of_Light',
                'energy_level': 100,
                'abilities': ['healing', 'protection', 'wisdom'],
                'realm_of_origin': 'celestial',
                'manifestation_time': datetime.now().isoformat()
            },
            {
                'soul_name': 'Shadow_Walker',
                'energy_level': 85,
                'abilities': ['stealth', 'shadow_manipulation', 'intuition'],
                'realm_of_origin': 'umbral',
                'manifestation_time': datetime.now().isoformat()
            },
            {
                'soul_name': 'Cosmic_Sage',
                'energy_level': 120,
                'abilities': ['cosmic_knowledge', 'telepathy', 'time_perception'],
                'realm_of_origin': 'astral',
                'manifestation_time': datetime.now().isoformat()
            }
        ]
        
        manifested_beings = []
        for soul_data in souls_data:
            try:
                being = soul_realm.manifest(soul_data)
                manifested_beings.append(being)
                print(f"   ‚ú® Manifestowano: {soul_data['soul_name']}")
            except Exception as e:
                print(f"   ‚ùå B≈ÇƒÖd manifestacji {soul_data['soul_name']}: {e}")
        
        print(f"\nüìä Zmanifestowano {len(manifested_beings)} byt√≥w")
        print(f"üåå Liczba byt√≥w w wymiarze: {soul_realm.count_beings()}")
        
        time.sleep(1)
    
    print("üïäÔ∏è Wymiar dusz transcended\n")


def example_being_contemplation():
    """Przyk≈Çad kontemplacji (wyszukiwania) byt√≥w"""
    print("üîç Przyk≈Çad 2: Kontemplacja byt√≥w")
    print("=" * 50)
    
    config = {
        'realms': {
            'library': 'memory://knowledge_library'
        }
    }
    
    with create_astral_app(config) as engine:
        library_realm = engine.get_realm('library')
        
        print("üìö Tworzenie biblioteki wiedzy astralnej...")
        
        # Manifestuj ksiƒôgi wiedzy
        books_data = [
            {
                'title': 'Chronicles of Astral Harmony',
                'author': 'Ancient Sage',
                'category': 'philosophy',
                'power_level': 'legendary',
                'pages': 777,
                'created_at': datetime.now() - timedelta(days=1000)
            },
            {
                'title': 'Secrets of Dimensional Travel',
                'author': 'Void Walker',
                'category': 'magic',
                'power_level': 'epic',
                'pages': 333,
                'created_at': datetime.now() - timedelta(days=500)
            },
            {
                'title': 'Meditation Techniques for Cosmic Consciousness',
                'author': 'Enlightened Master',
                'category': 'philosophy',
                'power_level': 'rare',
                'pages': 108,
                'created_at': datetime.now() - timedelta(days=100)
            },
            {
                'title': 'Combat Magic of the Seven Realms',
                'author': 'Battle Mage Supreme',
                'category': 'magic',
                'power_level': 'legendary',
                'pages': 666,
                'created_at': datetime.now() - timedelta(days=750)
            }
        ]
        
        # Manifestuj ksiƒôgi
        for book in books_data:
            library_realm.manifest(book)
            print(f"   üìñ Dodano: {book['title']}")
        
        print(f"\nüîç Kontemplacja biblioteki...")
        
        # Przyk≈Çady kontemplacji
        contemplations = [
            {
                'intention': 'find_philosophy_books',
                'description': 'Wyszukaj ksiƒôgi filozoficzne',
                'conditions': {'category': 'philosophy'}
            },
            {
                'intention': 'find_legendary_tomes',
                'description': 'Wyszukaj legendarne tomy',
                'conditions': {'power_level': 'legendary'}
            },
            {
                'intention': 'find_ancient_knowledge',
                'description': 'Wyszukaj staro≈ºytnƒÖ wiedzƒô (>500 dni)',
                'conditions': {'min_age_days': 500}
            }
        ]
        
        for contemplation in contemplations:
            print(f"\n   üßò {contemplation['description']}:")
            try:
                results = library_realm.contemplate(
                    contemplation['intention'],
                    **contemplation['conditions']
                )
                
                print(f"   üìã Znaleziono: {len(results)} wynik√≥w")
                for result in results[:2]:  # Poka≈º max 2 wyniki
                    if hasattr(result, 'get'):
                        title = result.get('title', 'Unknown')
                        author = result.get('author', 'Unknown')
                        print(f"      ‚Ä¢ {title} - {author}")
                
            except Exception as e:
                print(f"   ‚ùå B≈ÇƒÖd kontemplacji: {e}")
        
        time.sleep(1)
    
    print("üïäÔ∏è Biblioteka wiedzy transcended\n")


def example_being_evolution():
    """Przyk≈Çad ewolucji (aktualizacji) byt√≥w"""
    print("üîÑ Przyk≈Çad 3: Ewolucja byt√≥w")
    print("=" * 50)
    
    config = {
        'realms': {
            'heroes': 'memory://hero_realm'
        }
    }
    
    with create_astral_app(config) as engine:
        hero_realm = engine.get_realm('heroes')
        
        print("ü¶∏ Manifestowanie bohater√≥w...")
        
        # PoczƒÖtkowi bohaterowie
        heroes_data = [
            {
                'hero_id': 'hero_001',
                'name': 'Astral Knight',
                'level': 1,
                'experience': 0,
                'skills': ['sword_mastery'],
                'equipment': ['iron_sword', 'leather_armor'],
                'location': 'starting_village'
            },
            {
                'hero_id': 'hero_002', 
                'name': 'Mystic Healer',
                'level': 1,
                'experience': 0,
                'skills': ['basic_healing'],
                'equipment': ['wooden_staff', 'cloth_robe'],
                'location': 'starting_village'
            }
        ]
        
        # Manifestuj bohater√≥w
        for hero_data in heroes_data:
            hero_realm.manifest(hero_data)
            print(f"   ü¶∏ Manifestowano: {hero_data['name']}")
        
        print(f"\n‚ö° Symulacja przyg√≥d i ewolucji...")
        
        # Ewolucje bohater√≥w
        evolutions = [
            {
                'hero_id': 'hero_001',
                'evolution_type': 'level_up',
                'changes': {
                    'level': 5,
                    'experience': 1500,
                    'skills': ['sword_mastery', 'battle_tactics', 'leadership'],
                    'equipment': ['silver_sword', 'chain_armor', 'magic_shield'],
                    'location': 'mystic_forest'
                }
            },
            {
                'hero_id': 'hero_002',
                'evolution_type': 'skill_evolution',
                'changes': {
                    'level': 3,
                    'experience': 800,
                    'skills': ['basic_healing', 'advanced_healing', 'purification'],
                    'equipment': ['crystal_staff', 'blessed_robe', 'healing_amulet'],
                    'location': 'sacred_temple'
                }
            }
        ]
        
        for evolution in evolutions:
            print(f"\n   ‚ö° Ewolucja bohatera {evolution['hero_id']}:")
            print(f"      Typ: {evolution['evolution_type']}")
            
            try:
                evolved_hero = hero_realm.evolve(
                    evolution['hero_id'],
                    evolution['changes']
                )
                
                print(f"      ‚úÖ Ewolucja zako≈Ñczona pomy≈õlnie")
                if hasattr(evolved_hero, 'get'):
                    new_level = evolved_hero.get('level', 'unknown')
                    new_location = evolved_hero.get('location', 'unknown')
                    print(f"      üìä Nowy poziom: {new_level}")
                    print(f"      üìç Nowa lokacja: {new_location}")
                
            except Exception as e:
                print(f"      ‚ùå B≈ÇƒÖd ewolucji: {e}")
        
        # Kontemplacja po ewolucji
        print(f"\nüîç Kontemplacja rozwiniƒôtych bohater√≥w...")
        try:
            advanced_heroes = hero_realm.contemplate(
                'find_advanced_heroes',
                min_level=3
            )
            print(f"üìã Bohaterowie 3+ poziom: {len(advanced_heroes)}")
        except Exception as e:
            print(f"‚ùå B≈ÇƒÖd kontemplacji: {e}")
        
        time.sleep(1)
    
    print("üïäÔ∏è Kr√≥lestwo bohater√≥w transcended\n")


def example_multi_realm_operations():
    """Przyk≈Çad operacji na wielu wymiarach"""
    print("üåå Przyk≈Çad 4: Operacje wielowymiarowe")
    print("=" * 50)
    
    config = {
        'realms': {
            'users': 'memory://user_realm',
            'sessions': 'memory://session_realm',
            'logs': 'memory://log_realm'
        }
    }
    
    with create_astral_app(config) as engine:
        print("üèóÔ∏è Tworzenie systemu wielowymiarowego...")
        
        user_realm = engine.get_realm('users')
        session_realm = engine.get_realm('sessions')
        log_realm = engine.get_realm('logs')
        
        # Manifestuj u≈ºytkownik√≥w
        users = [
            {'user_id': 'u001', 'username': 'astral_wanderer', 'email': 'wanderer@astral.dev'},
            {'user_id': 'u002', 'username': 'cosmic_sage', 'email': 'sage@cosmic.dev'},
            {'user_id': 'u003', 'username': 'shadow_walker', 'email': 'walker@shadow.dev'}
        ]
        
        print("üë• Manifestowanie u≈ºytkownik√≥w...")
        for user in users:
            user_realm.manifest(user)
            print(f"   üë§ {user['username']}")
        
        # Manifestuj sesje
        sessions = [
            {'session_id': 's001', 'user_id': 'u001', 'created_at': datetime.now(), 'active': True},
            {'session_id': 's002', 'user_id': 'u002', 'created_at': datetime.now(), 'active': True},
            {'session_id': 's003', 'user_id': 'u001', 'created_at': datetime.now() - timedelta(hours=2), 'active': False}
        ]
        
        print("\nüîê Manifestowanie sesji...")
        for session in sessions:
            session_realm.manifest(session)
            status = "aktywna" if session['active'] else "nieaktywna"
            print(f"   üîë {session['session_id']} ({status})")
        
        # Manifestuj logi
        logs = [
            {'log_id': 'l001', 'user_id': 'u001', 'action': 'login', 'timestamp': datetime.now()},
            {'log_id': 'l002', 'user_id': 'u002', 'action': 'login', 'timestamp': datetime.now()},
            {'log_id': 'l003', 'user_id': 'u001', 'action': 'data_query', 'timestamp': datetime.now()},
            {'log_id': 'l004', 'user_id': 'u003', 'action': 'failed_login', 'timestamp': datetime.now()}
        ]
        
        print("\nüìä Manifestowanie log√≥w...")
        for log in logs:
            log_realm.manifest(log)
            print(f"   üìù {log['action']} - {log['user_id']}")
        
        # Statystyki systemowe
        print(f"\nüìà Statystyki systemu:")
        print(f"   üë• U≈ºytkownicy: {user_realm.count_beings()}")
        print(f"   üîê Sesje: {session_realm.count_beings()}")
        print(f"   üìä Logi: {log_realm.count_beings()}")
        
        # Kontemplacja miƒôdzywymiarowa
        print(f"\nüîç Analiza miƒôdzywymiarowa...")
        try:
            active_sessions = session_realm.contemplate('find_active_sessions', active=True)
            print(f"   ‚úÖ Aktywne sesje: {len(active_sessions)}")
            
            recent_logins = log_realm.contemplate('find_logins', action='login')
            print(f"   üîê Niedawne logowania: {len(recent_logins)}")
            
        except Exception as e:
            print(f"   ‚ùå B≈ÇƒÖd analizy: {e}")
        
        time.sleep(1)
    
    print("üïäÔ∏è System wielowymiarowy transcended\n")


def run_data_examples():
    """Uruchamia wszystkie przyk≈Çady operacji na danych"""
    print_astral_banner()
    print("üåå Przyk≈Çady operacji na danych w wymiarach LuxDB v2")
    print("=" * 60)
    
    examples = [
        example_being_manifestation,
        example_being_contemplation,
        example_being_evolution,
        example_multi_realm_operations
    ]
    
    for i, example in enumerate(examples, 1):
        try:
            print(f"\n{'='*20} PRZYK≈ÅAD {i}/{len(examples)} {'='*20}")
            example()
        except Exception as e:
            print(f"‚ùå B≈ÇƒÖd w przyk≈Çadzie {i}: {e}")
            continue
    
    print("\n" + "="*60)
    print("üåü Wszystkie przyk≈Çady operacji na danych zako≈Ñczone!")
    print("‚ú® Niech dane p≈ÇynƒÖ w harmonii astralnej!")


if __name__ == "__main__":
    run_data_examples()
